@model CommentServiceModel
@inject ICommentService commentService

<script src="~/lib/jquery/dist/jquery.min.js"></script>

<div class="row m-1">
    <div class="card col-md-8">
        <div class="card-header">
            <em>@Model.Date</em>
        </div>
        <div class="card-body">
            <blockquote class="blockquote mb-0">
                <p id ="js-content">"@Model.Content"</p>
                <footer class="blockquote-footer">
                    <cite title="Author">@Model.FullName</cite>
                </footer>
            </blockquote>
        </div>
    </div>
    <div id="js-buttons" class="col-md-1">
        @if (this.User.IsAdmin() || await this.commentService.HasAuthorWithIdAsync(Model.Id, User.Id()))
        {
            <form class="mt-2" id="js-edit" asp-controller="Comment" asp-action="Edit" asp-route-id="@Model.Id">
                <div class="d-grid gap-2">
                    <input type="submit" value="Edit" class="btn btn-sm btn-dark m-1"
                           onclick="return confirm('Are you sure you want to edit this comment?')" />
                </div>
            </form>
            <form class="mt-2" id="js-delete" asp-controller="Comment" asp-action="Delete" asp-route-id="@Model.Id">
                <div class="d-grid gap-2">
                    <input type="submit" value="Delete" class="btn btn-sm btn-dark m-1" 
                        onclick="return confirm('Are you sure you want to delete this comment?')" />
                </div>
            </form>
            @* <div class="btn btn-sm btn-dark m-1" id="js-edit">Edit</div> *@
            @* <div class="btn btn-sm btn-dark m-1" id="js-delete" onclick="return confirm('Are you sure you want to delete this comment?">Delete</div> *@
        }
    </div>
</div>

<script>
    $('#js-edit').on('click', function () {

        var projectId = @Model.Id;

        $.get('/Comment/Edit/', { projectId: projectId },
            function (data) {
                console.log(data);
                $('#js-add-comment-view').html(data);
            });
    });
</script>
<script>
    $('#js-edit').on('click', function () {

        var content = $('#js-content em').text();
        console.log(content);
        var textarea = `<textarea>${content}</textarea>`

        $('#js-content').html(textarea)
        var apply = '<a asp-area="" asp-controller="Project" asp-action="Delete" asp-route-id="@Model.Id" class="btn btn-dark m-1">Apply</a>'
        $('#js-buttons').html(apply);
        // var projectId = @Model.Id;

        // $.get('/Comment/Add/', { projectId: projectId },
        //     function (data) {
        //         console.log(data);
        //         $('#js-add-comment-view').html(data);
        //     });
    });
</script>



